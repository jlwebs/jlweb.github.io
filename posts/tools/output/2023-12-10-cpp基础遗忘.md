---
layout: post
title: "CPPåŸºç¡€é—å¿˜"
date: 2023-12-10
categories: jekyll
tags: ['ğŸ¥-CPP']
comments: true
---

#### 1.æ•°ç»„åå’Œæ•°ç»„æŒ‡é’ˆ
```cpp
int main() {
    int arr[5] = {1, 2, 3, 4, 5};
    int (*pArr)[5] = &arr;
    std::cout << arr << std::endl;  // è¾“å‡ºæ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ çš„åœ°å€
    std::cout << &arr[0] << std::endl;  // è¾“å‡ºæ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ çš„åœ°å€
    std::cout << pArr << std::endl;  // è¾“å‡ºæ•´ä¸ªæ•°ç»„çš„åœ°å€
    std::cout << ((void*)arr==(void*)pArr) << std::endl;  // 1
    std::cout << ((void*)arr==(void*)&arr) << std::endl;  // 1
    std::cout << (arr==&arr[0]) << std::endl;  // 1
}
```
pArræ˜¯ä¸€ä¸ªæ•°ç»„æŒ‡é’ˆï¼ŒpArrç±»å‹æ˜¯'int ()[5]'ï¼Œarrç±»å‹æ˜¯int*ï¼Œä¸€æ—¦ç¼–è¯‘å®Œæˆæœ¬è´¨éƒ½æ˜¯ä¸€æ ·çš„
pArråªæ˜¯ç±»å‹ä¸ä¸€æ ·è€Œå·²ï¼Œä½†æ˜¯ä»–ä»¬æŒ‡é’ˆå€¼ç›¸ç­‰ï¼Œarræœ¬æ¥å°±æ˜¯å­˜å‚¨æ•°ç»„é¦–ä¸ªä½ç½®äº†ï¼Œæˆ‘ç”¨&arrå†è·å–arrçš„åœ°å€é‚£è¿˜æ˜¯ ç›¸åŒçš„å†…å­˜ä½ç½®ï¼Œæ­¤æ—¶&arrå·²ç»æ˜¯rvalueäº†ï¼Œæ— æ³•å†æ±‚&&arräº†ã€‚
&arr[0]ä¹Ÿæ˜¯int*ï¼Œ å®ƒå’Œarrå°±æ˜¯ç­‰åŒä½¿ç”¨çš„ï¼Œæ— éœ€ç±»å‹è½¬æ¢ã€‚
}

#### 2.è‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•°cmpä¸èƒ½æ˜¯æˆå‘˜å‡½æ•°
:::success
_å¦‚æœæƒ³è¦ä½¿ç”¨æˆå‘˜å‡½æ•°ä½œä¸ºæ¯”è¾ƒå‡½æ•°ï¼Œå¯ä»¥å°†å…¶å£°æ˜ä¸ºé™æ€æˆå‘˜å‡½æ•°æˆ–ä½¿ç”¨ lambda è¡¨è¾¾å¼æ¥è°ƒç”¨ã€‚è¿™æ˜¯å› ä¸ºæˆå‘˜å‡½æ•°éœ€è¦é€šè¿‡å¯¹è±¡æ¥è°ƒç”¨ï¼Œè€Œ sort() åªæ¥å—å‡½æ•°æŒ‡é’ˆæˆ–å‡½æ•°å¯¹è±¡ã€‚å¦‚æœå°†æˆå‘˜å‡½æ•°ä½œä¸ºæ¯”è¾ƒå‡½æ•°ç›´æ¥ä¼ é€’ç»™ sort()ï¼Œä¼šå‡ºç°æˆå‘˜å‡½æ•°æ²¡æœ‰æŒ‡å®šè°ƒç”¨è€…çš„é—®é¢˜ï¼Œä»è€Œå¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚_
_æ²¡æœ‰è°ƒç”¨è€…baseæŒ‡é’ˆä¿¡æ¯ï¼Œæˆå‘˜å‡½æ•°å°±æ— æ³•æ­£ç¡®è®¿é—®_æˆå‘˜å˜é‡å’Œå…¶ä»–æˆå‘˜å‡½æ•°ã€‚
:::
ç»™å‡ºä¸€ä¸ªé”™è¯¯ç¤ºèŒƒ
```cpp
#include <iostream>
#include <vector>
#include <algorithm>

class MyClass {
public:
    MyClass(int v1, int v2) : m_val1(v1), m_val2(v2) {}

    bool compare1(MyClass& other) {
        return m_val1 > other.m_val1;
    }

    bool compare2(MyClass& other) {
        return m_val2 > other.m_val2;
    }

    void my_sort(std::vector<MyClass>& vec) {
        ::my_sort(vec, compare1);  
        // é”™è¯¯ç¤ºèŒƒï¼šç›´æ¥ä¼ é€’æˆå‘˜å‡½æ•°æŒ‡é’ˆä¼šå‡ºç°æˆå‘˜å‡½æ•°æ²¡æœ‰æŒ‡å®šè°ƒç”¨è€…çš„é—®é¢˜
    }

private:
    int m_val1, m_val2;
};

void my_sort(std::vector<MyClass>& vec, bool (*func_ptr)(MyClass&, MyClass&)) {
    for (auto i = vec.begin(); i != vec.end(); ++i) {
        for (auto j = i + 1; j != vec.end(); ++j) {
            if (func_ptr(*j, *i)) {
                std::swap(*i, *j);
            }
        }
    }
}

int main() {
    MyClass obj(4, 2);
    std::vector<MyClass> vec = {MyClass(3, 5), MyClass(1, 8), MyClass(2, 4)};
    obj.my_sort(vec);
    for (const auto& item : vec) {
        std::cout << "(" << item.compare1(obj) << ", " << item.compare2(obj) << ") ";
    }
    std::cout << std::endl;

    return 0;
}
```
```cpp
class MyClass {
public:
    MyClass(int v) : m_val(v) {}

    int get_val() const {
        return m_val;
    }

private:
    int m_val;
};

int main() {
    MyClass obj(42);

    int (MyClass::*get_val_ptr)() const = &MyClass::get_val;
    int val = (obj.*get_val_ptr)();

    return 0;
}
```
```cpp
MyClass obj(42);
    mov     DWORD PTR [rbp-4], 42   ; åˆ›å»ºå¯¹è±¡ objï¼Œå¹¶å°†å…¶æˆå‘˜å˜é‡ m_val çš„å€¼è®¾ç½®ä¸º 42

    int (MyClass::*get_val_ptr)() const = &MyClass::get_val;
    lea     rax, [rip+get_val_ptr]  ; å°†æˆå‘˜å‡½æ•°æŒ‡é’ˆçš„åœ°å€å­˜å‚¨åˆ° rax å¯„å­˜å™¨ä¸­

    int val = (obj.*get_val_ptr)();
    lea     rcx, [rbp-4]            ; å°†å¯¹è±¡ obj çš„åœ°å€å­˜å‚¨åˆ° rcx å¯„å­˜å™¨ä¸­ï¼Œä½œä¸ºè°ƒç”¨è€…çš„æŒ‡é’ˆ
    mov     rax, QWORD PTR [rax]    ; å°†æˆå‘˜å‡½æ•°æŒ‡é’ˆçš„å€¼ï¼ˆå³æˆå‘˜å‡½æ•°çš„åœ°å€ï¼‰å­˜å‚¨åˆ° rax å¯„å­˜å™¨ä¸­
    call    rax                     ; è°ƒç”¨æˆå‘˜å‡½æ•°ï¼Œå¹¶å°†è¿”å›å€¼å­˜å‚¨åˆ° eax å¯„å­˜å™¨ä¸­
```

#### 3.é™å®šåŸŸä¸‹ç†è§£è™šå‡½æ•°è°ƒç”¨æ˜“é”™ä¾‹é¢˜
```cpp
#include <iostream>
#include <bits/stdc++.h>
using namespace std;

class Base{
    protected:
    int m_data;
    
public:
    Base(int data = 0)
    {    m_data = data;}
    
    int GetData()
    {    return DoGetData();}
    
    virtual int DoGetData(){
        return m_data;
    }

};

class Derive : public Base
{
public:
    Derive(int data = 1)
    {
        m_data = data;
    }
    int DoGetData() override
    {
        return m_data;
    }
protected:
    int m_data;
};

int main()
{
    Derive d;
    std::cout << d.GetData() << std::endl;
    std::cout << d.DoGetData() << std::endl;
    std::cout << d.Base::GetData() << std::endl;
    std::cout << d.Base::DoGetData() << std::endl;
    return 0;
}

```
ç”±äºDeriveæ„é€ è¿‡ç¨‹ï¼Œä¼šé¦–å…ˆæ‰§è¡ŒåŸºç±»æ„é€ å‡½æ•°;ç”±äºæ´¾ç”Ÿç±»å£°æ˜äº†é‡åå˜é‡å’Œå‡½æ•°ï¼Œè¢«ç¼–è¯‘å™¨è¿›è¡Œäº†éšè—æ“ä½œï¼Œæ­¤æ—¶Då†…å­˜ç©ºé—´å˜æˆäº†ï¼š
:::success
Base::DoGetData(){return Base::m_data;};
Base::m_data;
Base::GetData();
:::
Deriveæ„é€ å®Œæˆåå˜æˆäº†
:::success
Base::DoGetData(){return Base::m_data;};
Base::m_data;ã€æ³¨æ„è¿™ä¸ªå˜é‡æ˜¯å®æ‰“å®æ‹·è´åˆ°dç©ºé—´é‡Œçš„ã€‘
m_data;
void* vptr; //æŒ‡å‘Deriveç±»è™šè¡¨çš„æŒ‡é’ˆ
DoGetData(){return Derive::m_data;};
Base::GetData( call *this.vptr[0] ());ã€æ²¡æœ‰è¢«è¦†ç›–å› æ­¤ï¼ŒDerive::GetData();ä¹Ÿä¼šå¯¼å‘å®ƒã€‘
:::
å› æ­¤
    std::cout << d.GetData() << std::endl;
    std::cout << d.DoGetData() << std::endl;
å‰ä¸¤ä¸ªä¸º1å› ä¸ºè®¿é—®åˆ°çš„å‡½æ•°éƒ½æ˜¯åœ¨DeriveåŸŸå†…çš„ï¼Œè‡ªç„¶ä¹Ÿä¼šè®¿é—®å…¶å†…çš„å˜é‡m_dataï¼›
  std::cout << d.Base::GetData() << std::endl;
è€Œç¬¬ä¸‰ä¸ªè¿™ä¸ªï¼Œç”±äºæ¶‰åŠåˆ°è™šå‡½æ•°è°ƒç”¨ï¼Œå› æ­¤ç¼–è¯‘å™¨å¤„ç†è¿™é‡Œæ˜¯è½¬ä¸ºäº†è™šè¡¨æŒ‡é’ˆå»æ‰¾DoGetDataçš„ä½ç½®ï¼Œå°±æ˜¯è¯´Base::åªä¼šåœ¨æ—©ç»‘å®šä¸­å®ŒæˆåŸºç±»ç©ºé—´çš„å®šä½ï¼Œè€Œè°ƒç”¨è™šå‡½æ•°DoGetDataéƒ½æ˜¯ç»Ÿä¸€ä»ç¤ºä¾‹ç©ºé—´å»æ‰¾çš„vptrå€¼ï¼ˆå³ä¼šä»då†…å­˜æ‰¾åˆ°å‡½æ•°åœ°å€ï¼‰
    std::cout << d.Base::DoGetData() << std::endl;
è¿™ä¸ªå°±ä¼šç›´æ¥è®¿é—®åˆ°Baseçš„å‡½æ•°ä»£ç æ®µï¼Œé‡Œé¢è®¿é—®åˆ°çš„å˜é‡æ˜¯Base::m_data
ã€å‡†ç¡®æ¥è¯´ã€‘ç»¿è‰²æ¡†å¦‚æœä»£è¡¨då†…å­˜åŒºåŸŸï¼Œé‚£ä¹ˆæ‰€æœ‰å‡½æ•°éƒ½ä¸åœ¨é‡Œé¢çš„ï¼Œä½äºtextåªè¯»æ‰§è¡Œä»£ç æ®µï¼Œåªæœ‰3ä¸ªå˜é‡ä¼šå­˜åœ¨äºæ ˆå†…å­˜ä¸Šï¼›
:::success
vptr;  		// _this$[ebp]
Base::m_data; 	//_this$[ebp+4]
m_data; 		//_this$[ebp+8]
:::
ã€æ±‡ç¼–è§£è¯»ã€‘ä¸ºä»€ä¹ˆæˆ‘çœ‹åˆ°doGetData()æ±‡ç¼–å”¯ä¸€åŒºåˆ«ï¼šåœ¨åŸºç±»æ˜¯mov eax, DWORD PTR [eax+4]ï¼›è€Œåœ¨æ´¾ç”Ÿç±»é‡Œæ˜¯mov eax, DWORD PTR [eax+8]ï¼›
è¿™æ˜¯ç”±äºåœ¨æ´¾ç”Ÿç±»ä¸­ï¼Œä¼šåŒ…å«åŸºç±»çš„æˆå‘˜ã€‚åœ¨åŸºç±»ä¸­ï¼Œ**m_data** æ˜¯ **int m_data;**ï¼Œåœ¨æ´¾ç”Ÿç±»ä¸­ä¹Ÿæœ‰ä¸€ä¸ª **int m_data;**ã€‚
åœ¨åŸºç±»çš„å®ä¾‹ä¸­ï¼Œ**m_data** æ˜¯å¯¹è±¡çš„ç¬¬ä¸€ä¸ªæˆå‘˜ï¼Œæ‰€ä»¥å®ƒçš„åç§»é‡æ˜¯ 0ã€‚åœ¨æ´¾ç”Ÿç±»ä¸­ï¼Œ**m_data** ä¼šè¢«æ”¾åœ¨åŸºç±»æˆå‘˜çš„åé¢ï¼Œæ‰€ä»¥å®ƒçš„åç§»é‡ä¼šæ˜¯åŸºç±»æˆå‘˜çš„å¤§å°ï¼Œä¹Ÿå°±æ˜¯ 4 å­—èŠ‚ã€‚
å› æ­¤ï¼Œåœ¨æ±‡ç¼–ä¸­ä½ çœ‹åˆ°äº†ä¸åŒçš„åç§»é‡ï¼š

   - åœ¨åŸºç±»ä¸­ï¼Œ**m_data** çš„åœ°å€æ˜¯ **[eax+4]**ï¼Œè¡¨ç¤ºç›¸å¯¹äºå¯¹è±¡çš„èµ·å§‹åœ°å€åç§» 4 å­—èŠ‚å¤„ã€‚
   - åœ¨æ´¾ç”Ÿç±»ä¸­ï¼Œ**m_data** çš„åœ°å€æ˜¯ **[eax+8]**ï¼Œè¡¨ç¤ºç›¸å¯¹äºå¯¹è±¡çš„èµ·å§‹åœ°å€åç§» 8 å­—èŠ‚å¤„ã€‚

è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½ åœ¨æ±‡ç¼–ä¸­çœ‹åˆ°äº†ä¸åŒçš„åç§»é‡çš„åŸå› ã€‚è¿™ç§åç§»é‡çš„å˜åŒ–æ˜¯ç”±äºæ´¾ç”Ÿç±»ä¸­åŒ…å«äº†åŸºç±»çš„æˆå‘˜æ‰€å¯¼è‡´çš„ã€‚
ã€ç»“è®ºã€‘ OOPé‡Œé¢çš„å‡½æ•°è®¿é—®çš„éƒ½æ˜¯å”¯ä¸€æ ‡è¯†çš„è‡ªå·±å˜é‡ï¼Œé€šå¸¸æ˜¯åŸºç±»åœ¨å†…å­˜å‰é¢ï¼Œæ´¾ç”Ÿç±»çš„å˜é‡åœ¨åé¢ï¼›
å¦‚æœè°ƒç”¨äº†è™šå‡½æ•°ï¼Œæ— è®ºæ€æ ·éƒ½ä¼šå¯¼å‘å®ä¾‹å†…å­˜çš„è™šè¡¨æ‰€æŒ‡å‡½æ•°ï¼ˆå¦‚æœä¸ºå®ä¾‹é‡å†™äº†è¯¥å‡½æ•°ï¼Œå°±ä¸€å®šä¼šè®¿é—®è‡ªå·±é‡å†™çš„ï¼‰
#### 4.staticå‡½æ•°å·¥ç¨‹é‡Œä½¿ç”¨å‡†åˆ™
ä¸ºä»€ä¹ˆå¤´æ–‡ä»¶é‡Œä¸è¦å‡ºç°staticå‡½æ•°ï¼Ÿ

å¦‚æœåœ¨å¤´æ–‡ä»¶ä¸­å£°æ˜äº†staticå‡½æ•°ï¼Œé‚£ä¹ˆæ‰€æœ‰åŒ…å«å®ƒçš„æºæ–‡ä»¶éƒ½ä¼šå­˜åœ¨è¯¥staticå‡½æ•°å£°æ˜ã€‚å¦‚æœä¸€äº›æºæ–‡ä»¶è¦ä½¿ç”¨è¯¥å‡½æ•°ï¼Œç”±äºstaticå‡½æ•°ä»…åœ¨å½“å‰æºæ–‡ä»¶ä½œç”¨åŸŸå¯è§ï¼Œé‚£ä¹ˆå¿…é¡»åœ¨æ¯ä¸€ä¸ªè¦ä½¿ç”¨è¯¥å‡½æ•°çš„æºæ–‡ä»¶ä¸­éƒ½æœ‰å‡½æ•°å®ç°ï¼Œå¦‚æœä»…åœ¨ä¸€ä¸ªæºæ–‡ä»¶ä¸­å®ç°ï¼Œå…¶ä»–æºæ–‡ä»¶ä½¿ç”¨åˆ™ä¼šç¼–è¯‘é”™è¯¯ï¼Œå› ä¸ºè¿™ä¸ªå®ç°å¯¹äºå…¶ä»–æºæ–‡ä»¶æ˜¯ä¸å¯è§çš„ã€‚

å¦‚æœåœ¨æ¯ä¸€ä¸ªæºæ–‡ä»¶éƒ½å®ç°ä¸€æ¬¡ç›¸åŒçš„å‡½æ•°ï¼Œåˆ™ä¼šä»£ç å†—ä½™ã€ç¨‹åºå˜å¤§ï¼Œä¸å¦‚å®šä¹‰æˆæ™®é€šå‡½æ•°ï¼Œä»…æœ‰ä¸€å¤„å®ç°ã€ä¸€ä»½æ‰§è¡Œç ã€‚å¦‚æœåœ¨ä¸åŒæºæ–‡ä»¶æœ‰ä¸åŒçš„å®ç°ï¼Œé‚£ä¹ˆå¤´æ–‡ä»¶ä¸­çš„å‡½æ•°å£°æ˜å°±æœ‰å¤šä¸ªä¸åŒå®ç°ï¼Œå«ä¹‰ä¸æ˜ç¡®ï¼Œä¼šé€ æˆæ­§ä¹‰ï¼Œç›´æ¥æ”¾åˆ°æºæ–‡ä»¶å³å¯ã€‚

æ‰€ä»¥ï¼Œåœ¨å¤´æ–‡ä»¶é‡Œä¸è¦å‡ºç°staticå‡½æ•°çš„å£°æ˜ã€‚
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
åŸæ–‡é“¾æ¥ï¼š[https://blog.csdn.net/fengyuesong/article/details/130315767](https://blog.csdn.net/fengyuesong/article/details/130315767)
demoæœ¬åœ°ï¼šC:\Users\ding\Desktop\project\dean\static-refer-test

#### 5.unionå’Œstructå¤§å°è®¡ç®—æœ€ä½³è®°å¿†æ³•
[è®¡ç®—ç»“æ„ä½“å¤§å°ï¼ˆå†…å­˜å¯¹é½åŸåˆ™ï¼‰structã€unionã€class_unionå¤§å°è®¡ç®—-CSDNåšå®¢](https://blog.csdn.net/weixin_51547017/article/details/127737623)
#### 6.const å¼•ç”¨æ¥æ”¶å‚æ•°çš„ä½œç”¨

1. é¿å…äº†æ‹·è´æ„é€ å‡½æ•°çš„é€’å½’è°ƒç”¨ï¼ˆé”™ï¼Œè¿™æ˜¯å¼•ç”¨å£°æ˜çš„ç”¨é€”ï¼Œå’Œconstæ— å…³ï¼‰
2. é‡è½½è§„åˆ™çš„ä¸åŒï¼ˆå¸¸æˆå‘˜å‡½æ•°ä¸è®¨è®ºï¼‰
   1. é¡¶å±‚constä¸å½±å“ä¼ å…¥å‡½æ•°çš„å¯¹è±¡ï¼Œä¸æ„æˆå‡½æ•°é‡è½½
> void fun(const int a);
> å®é™…ä¸Šæ²¡æœ‰åŒºåˆ«ï¼Œå› ä¸ºå‡½æ•°è°ƒç”¨çš„æ—¶å€™ï¼Œå­˜åœ¨å½¢å®ç»“åˆçš„è¿‡ç¨‹ï¼Œæ‰€ä»¥ä¸ç®¡æœ‰æ²¡æœ‰constéƒ½ä¸ä¼šæ”¹å˜å®å‚çš„å€¼ã€‚

   2. å¦‚æœå‡½æ•°çš„å½¢å‚æ˜¯æŸç§ç±»å‹çš„æŒ‡é’ˆæˆ–å¼•ç”¨ï¼Œé€šè¿‡åŒºåˆ†æŒ‡å‘çš„æ˜¯å¸¸é‡å¯¹è±¡è¿˜æ˜¯éå¸¸é‡å¯¹è±¡å¯ä»¥å®ç°å‡½æ•°é‡è½½ã€‚æ„æˆå‡½æ•°é‡è½½
> å³ 1ï¼‰åŒºåˆ†æŒ‡é’ˆä¸æŒ‡å‘å¸¸é‡çš„æŒ‡é’ˆï¼›2ï¼‰åŒºåˆ†å¼•ç”¨ä¸å¸¸é‡çš„å¼•ç”¨ 

3. _æ‹·è´æ„é€ _çš„å‚æ•°æ˜¯const ç±»å‹,æ‰€ä»¥æ—¢å¯ä»¥è¿›è¡Œå·¦å€¼å¼•ç”¨ä¹Ÿå¯ä»¥è¿›è¡Œå³å€¼å¼•ç”¨
> æ‹·è´æ„é€ å‡½æ•°ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡å¹¶å°†åŸå§‹å¯¹è±¡çš„å€¼å¤åˆ¶åˆ°æ–°å¯¹è±¡ä¸­ã€‚æ‹·è´æ„é€ å‡½æ•°é€šå¸¸é€šè¿‡"const &"è¡¨ç¤ºå·¦å€¼å¼•ç”¨ã€‚
> ç¼–è¯‘å™¨åœ¨å†³å®šä½¿ç”¨ç§»åŠ¨æ„é€ è¿˜æ˜¯æ‹·è´æ„é€ æ—¶ï¼Œä¼šæ ¹æ®å¯¹è±¡çš„å€¼ç±»åˆ«ï¼ˆå·¦å€¼æˆ–å³å€¼ï¼‰æ¥è¿›è¡Œé€‰æ‹©ã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡æ˜¯å³å€¼ï¼Œç¼–è¯‘å™¨ä¼šä¼˜å…ˆé€‰æ‹©ç§»åŠ¨æ„é€ å‡½æ•°ï¼›å¦‚æœä¸€ä¸ªå¯¹è±¡æ˜¯å·¦å€¼ï¼Œç¼–è¯‘å™¨ä¼šé€‰æ‹©æ‹·è´æ„é€ å‡½æ•°ã€‚
> ä½†æ˜¯ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡æ²¡æœ‰å®šä¹‰ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œæˆ–è€…å¯¹è±¡çš„èµ„æºæ— æ³•è¢«ç§»åŠ¨ï¼Œç¼–è¯‘å™¨ä¼šé€‰æ‹©ä½¿ç”¨æ‹·è´æ„é€ å‡½æ•°è¿›è¡Œæ‹·è´æ“ä½œã€‚

å¦‚æœfunc() { A a(1);return std::move(a);}  æ¥æ”¶æ–¹ auto obj = func()ï¼›è¿™æ—¶å€™å°±ä¼šä¼˜å…ˆåŒ¹é…ç§»åŠ¨æ„é€ ï¼Œå¦‚æœç¼–è¯‘å™¨æ²¡æœ‰é»˜è®¤ç”Ÿæˆç§»åŠ¨æ„é€ è‡ªå·±ä¹Ÿæ²¡æœ‰å®šä¹‰ï¼Œé‚£å°±è½¬è€Œè°ƒç”¨æ‹·è´æ„é€ A(const A& s);
æˆ‘ä»¬åˆ†æä¸‹ç¦ç”¨è¿”å›å€¼ä¼˜åŒ–ä¸‹ï¼Œè°ƒç”¨æƒ…å†µæ˜¯ä»€ä¹ˆï¼š
> return a;çš„æƒ…å†µå¦‚ä¸‹
> 1. è°ƒç”¨æ„é€ å‡½æ•°ï¼Œç”Ÿæˆå¯¹è±¡
> 2. è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ï¼Œç”Ÿæˆä¸´æ—¶å¯¹è±¡
> 3. ææ„ç¬¬1æ­¥ç”Ÿæˆçš„å¯¹è±¡
> 4. è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ï¼Œå°†ç¬¬2æ­¥ç”Ÿæˆçš„ä¸´æ—¶å˜é‡æ‹·è´åˆ°main()å‡½æ•°ä¸­çš„å±€éƒ¨å¯¹è±¡objä¸­
> 5. è°ƒç”¨ææ„å‡½æ•°ï¼Œé‡Šæ”¾ç¬¬2éƒ¨ç”Ÿæˆçš„ä¸´æ—¶å¯¹è±¡
> 6. è°ƒç”¨ææ„å‡½æ•°ï¼Œé‡Šæ”¾main()å‡½æ•°ä¸­çš„objå±€éƒ¨å¯¹è±¡

```cpp
#include <iostream>
#include <cstring>

class MyClass {
private:
char* str;
int n;

public:
// æ„é€ å‡½æ•°
MyClass(int n) {
    std::cout << "constructor "  << std::endl;
}

// æ‹·è´æ„é€ å‡½æ•°
MyClass(const MyClass& other) {
    std::cout << "Copy constructor called" << std::endl;
}

// ç§»åŠ¨æ„é€ å‡½æ•°
MyClass(MyClass&& other)  {
    str = other.str;
    other.str = nullptr;
    std::cout << "Move constructor called" << std::endl;
}

// ææ„å‡½æ•°
~MyClass() {
    std::cout<<"destructor()"<<std::endl;
    //delete str;
}

};
MyClass func(){
    // auto cs = (MyClass(1));
    // return std::move(cs);
    return MyClass(0);
}
int main() {

    MyClass obj = func();
    //MyClass obj2 = obj;
    return 0;
}

```
ç¬¬ä¸€ç§æƒ…å†µï¼š![image.png](../images/1699249116270-2f577283-3254-4f69-99eb-25ba1f8d6401.png)
[C++17ä¹‹çœç•¥ä¸å¿…è¦çš„æ‹·è´Copy Elision_c++ è¿”å›å¼•ç”¨ é¿å…æ‹·è´-CSDNåšå®¢](https://blog.csdn.net/janeqi1987/article/details/100146445)
[C++ä¸ºä»€ä¹ˆçº¯å³å€¼èƒ½è¢«å»¶è¿Ÿææ„ï¼Œå°†äº¡å€¼å´ä¸è¡Œï¼Ÿ - çŸ¥ä¹](https://www.zhihu.com/question/604327959/answer/3093341055)
ç»“æœï¼šï¼ˆå¼€å¯ç¦ç”¨è¿”å›å€¼ä¼˜åŒ–ï¼‰
![image.png](../images/1699249140988-bd62873c-2b25-48d9-a128-07b57aa53015.png)

1. 

